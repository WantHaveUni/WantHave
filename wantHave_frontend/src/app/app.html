<mat-sidenav-container class="app-sidenav-container">
  <!-- Mobile Navigation Drawer -->
  <mat-sidenav
    #sidenav
    mode="over"
    position="start"
    [opened]="isMobileMenuOpen()"
    (closed)="closeMobileMenu()"
    class="mobile-nav-drawer">

    <div class="mobile-nav-header">
      <a routerLink="/" class="mobile-brand" (click)="closeMobileMenu()">
        <img src="images/wanthave_logo.png" alt="Wanthave" />
      </a>
      <button mat-icon-button (click)="closeMobileMenu()" class="close-btn" aria-label="Close menu">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <nav class="mobile-nav-list">
      <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
        (click)="closeMobileMenu()" class="mobile-nav-item">
        <mat-icon>home</mat-icon>
        <span>Home</span>
      </a>

      @if (auth.isAdmin()) {
      <a routerLink="/admin" routerLinkActive="active"
        (click)="closeMobileMenu()" class="mobile-nav-item">
        <mat-icon>admin_panel_settings</mat-icon>
        <span>Admin</span>
      </a>
      }

      @if (auth.isAuthenticated()) {
      <a routerLink="/create-listing" routerLinkActive="active"
        (click)="closeMobileMenu()" class="mobile-nav-item">
        <mat-icon>add_circle</mat-icon>
        <span>Add Product</span>
      </a>

      <a routerLink="/chat" routerLinkActive="active"
        (click)="closeMobileMenu()" class="mobile-nav-item">
        <mat-icon [matBadge]="unreadCount" [matBadgeHidden]="unreadCount === 0"
          matBadgeColor="warn">chat</mat-icon>
        <span>Chat</span>
      </a>

      <a routerLink="/profile" routerLinkActive="active"
        (click)="closeMobileMenu()" class="mobile-nav-item">
        <mat-icon>person</mat-icon>
        <span>{{ auth.username() }}</span>
      </a>

      <div class="mobile-nav-divider"></div>

      <button (click)="logout(); closeMobileMenu()" class="mobile-nav-item logout-btn">
        <mat-icon>logout</mat-icon>
        <span>Logout</span>
      </button>
      } @else {
      <a routerLink="/login" routerLinkActive="active"
        (click)="closeMobileMenu()" class="mobile-nav-item">
        <mat-icon>login</mat-icon>
        <span>Login</span>
      </a>
      }
    </nav>
  </mat-sidenav>

  <mat-sidenav-content class="app-sidenav-content">
    <!-- Main Toolbar -->
    <mat-toolbar class="app-toolbar" color="primary">
      <!-- Burger Menu Button (Mobile Only) -->
      @if (isMobile()) {
      <button mat-icon-button (click)="toggleMobileMenu()" class="burger-btn"
        aria-label="Toggle navigation menu">
        <mat-icon>menu</mat-icon>
      </button>
      }

      <a routerLink="/" class="brand" aria-label="Go to homepage" title="Go to homepage">
        <img src="images/wanthave_logo.png" alt="Wanthave" draggable="false" />
      </a>

      <span class="spacer"></span>

      <!-- Desktop Navigation -->
      @if (!isMobile()) {
      @if (auth.isAdmin()) {
      <a mat-button routerLink="/admin" routerLinkActive="active">Admin</a>
      }
      @if (auth.isAuthenticated()) {
      <a mat-button routerLink="/create-listing" routerLinkActive="active">+ Add product</a>
      <a mat-button routerLink="/chat" routerLinkActive="active"
        [matBadge]="unreadCount" [matBadgeHidden]="unreadCount === 0" matBadgeColor="warn">
        Chat
      </a>
      }
      @if (!auth.isAuthenticated()) {
      <a mat-button routerLink="/login" routerLinkActive="active">Login</a>
      }
      @if (auth.isAuthenticated()) {
      <a mat-button routerLink="/profile" routerLinkActive="active">
        {{ auth.username() }}
      </a>
      <button mat-stroked-button (click)="logout()">Logout</button>
      }
      }
    </mat-toolbar>

    <main class="app-shell">
      <router-outlet></router-outlet>
    </main>

    @if (router.url !== '/chat') {
    <app-footer></app-footer>
    }
  </mat-sidenav-content>
</mat-sidenav-container>
